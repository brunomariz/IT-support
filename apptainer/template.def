Bootstrap: docker
From: ubuntu:latest

%environment
    export VAR=VALUE
  
%post
    apt update -y
    apt install -y python

%test
    which python | grep -q "/venv/bin/python"
    if [ $? -eq 0 ]; then
        echo "python installed and using appropriate venv"
    else
        echo "python installation error"
        exit 1
    fi

%labels
    Author "Bruno Mariz"

%help
    Built on: {{CONTAINER_BUILD_DATE}}

    This container is an apptainer version of the official Devito image https://hub.docker.com/r/devitocodes/devito.

    Usage: 
        apptainer exec container.sif command
        Examples:
            apptainer exec container.sif python -c "print('Hello world!')"
         
    Argument list:

        CONTAINER_BUILD_DATE
            specify date container was built. Example:
            apptainer build --build-arg CONTAINER_BUILD_DATE="$(date)" container.sif  container.def
